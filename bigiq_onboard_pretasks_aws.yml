---
- name: Pre-tasks for BIG-IQ deployed in the Cloud (AWS)
  hosts: f5-bigiq
  serial: 1
  gather_facts: False
  tasks:
    - name: tmsh modify auth password admin
      raw: bash -c "echo -en \"{{ hostvars[inventory_hostname].bigiq_default_admin_pwd }}\n{{ hostvars[inventory_hostname].bigiq_default_admin_pwd }}\n\" | tmsh modify auth password admin"
    
    # duplicating the command twice as the 1st attempt sometime fails.
    - name: tmsh modify auth password admin
      raw: bash -c "echo -en \"{{ hostvars[inventory_hostname].bigiq_default_admin_pwd }}\n{{ hostvars[inventory_hostname].bigiq_default_admin_pwd }}\n\" | tmsh modify auth password admin"

    - name: tmsh modify auth user admin shell bash
      raw: bash -c "tmsh modify auth user admin shell bash; tmsh save sys config"